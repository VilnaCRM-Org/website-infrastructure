version: 0.2

env:
  variables:
    HURL_DIR: './hurl'
    HURL_VERSION: '4.2.0'
    INSTALL_DIR: '/tmp'

phases:
  install:
    commands:
      - 'curl --silent --location https://github.com/Orange-OpenSource/hurl/releases/download/$HURL_VERSION/hurl-$HURL_VERSION-x86_64-unknown-linux-gnu.tar.gz | tar xvz -C $INSTALL_DIR'
      - 'export PATH=$INSTALL_DIR/hurl-$HURL_VERSION:$PATH'

  build:
    commands:
      - 'echo ## Test Website Connection...'
      - 'hurl --test --variable website_url=$WEBSITE_URL ${CODEBUILD_SRC_DIR}/${HURL_DIR}/healthcheck.hurl'

artifacts:
  files:
    - '**/*'
